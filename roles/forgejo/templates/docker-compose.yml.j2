# Forgejo Docker Compose configuration
# Generated by Ansible - DO NOT EDIT MANUALLY
# 
# This configures Forgejo (self-hosted Git service) running in Docker.
# Port mappings:
#   - HTTP: {{ forgejo_port_http }}:3000
#   - SSH: {{ forgejo_port_ssh }}:22
# Data is persisted in a named Docker volume: forgejo_data

version: '3'

services:
  forgejo:
    image: codeberg.org/forgejo/forgejo:latest
    container_name: forgejo
    restart: unless-stopped
    ports:
      - "{{ forgejo_port_http }}:3000"
      - "{{ forgejo_port_ssh }}:22"
    volumes:
      - forgejo_data:/data
    environment:
      - USER_UID=1000
      - USER_GID=1000
      # Add any environment variables here if needed
    # Health check to ensure service is running properly
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3000"]
      interval: 1m
      timeout: 10s
      retries: 3
      start_period: 40s

volumes:
  forgejo_data:
    # Using a named volume for data persistence